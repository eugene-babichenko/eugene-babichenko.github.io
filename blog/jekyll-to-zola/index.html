<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content="index, follow" name=robots><link href=https://eugene-babichenko.github.io/rss.xml rel=alternate title=RSS type=application/rss+xml><title>Eugene Babichenko | Migrating from Jekyll to Zola while preserving permalinks</title><link as=style href=https://eugene-babichenko.github.io/css/style.css rel=preload><link crossorigin href=https://raw.githack.com/Speyll/suCSS/main/reset-min.css rel=stylesheet><link crossorigin href=https://raw.githack.com/Speyll/suCSS/main/suCSS-min.css rel=stylesheet><link href=https://eugene-babichenko.github.io/css/style.css rel=stylesheet><link href=https://eugene-babichenko.github.io/css/custom.css rel=stylesheet><link href=https://eugene-babichenko.github.io/favicon.ico rel=icon><body><nav id=nav-bar><a href=/> /home/ </a><a href=/blog> /blog/ </a><a href=https://github.com/eugene-babichenko> /github/ </a><a href=https://standwithukraine.com.ua/> /ðŸ‡ºðŸ‡¦ Support Ukraine/ </a><div aria-label="Toggle theme" class=theme-toggle data-icon-base=https://eugene-babichenko.github.io/icons.svg data-icon-dark=#darkMode data-icon-light=#lightMode data-sound-src=https://eugene-babichenko.github.io/click.ogg id=theme-toggle role=button tabindex=0><svg class=icon><use id=theme-icon></use></svg></div></nav><main><article class=post><header class=post-header><time datetime=2024-06-17>Published on: <span class=accent-data>2024-06-17</span> </time><h1>Migrating from Jekyll to Zola while preserving permalinks</h1></header><div class=toc-container><h2>Table of content</h2><ul><li><a href=https://eugene-babichenko.github.io/blog/jekyll-to-zola/#intro>Intro</a><li><a href=https://eugene-babichenko.github.io/blog/jekyll-to-zola/#the-setup>The setup</a><li><a href=https://eugene-babichenko.github.io/blog/jekyll-to-zola/#timestamps>Timestamps</a><li><a href=https://eugene-babichenko.github.io/blog/jekyll-to-zola/#permalinks>Permalinks</a><li><a href=https://eugene-babichenko.github.io/blog/jekyll-to-zola/#preserving-feed-xml>Preserving feed.xml</a><li><a href=https://eugene-babichenko.github.io/blog/jekyll-to-zola/#fixing-links-in-anemone>Fixing links in Anemone</a><li><a href=https://eugene-babichenko.github.io/blog/jekyll-to-zola/#conclusion>Conclusion</a></ul></div><div class=post-content><h2 id=intro>Intro</h2><p>I've been deploying this blog using <a href=https://jekyllrb.com/>Jekyll</a> for quite a while now. This is the default choice for GitHub Pages, so why not. I've only been writing here occasionally from the same laptop, so it did not bother me too much. <em>Until it did</em>.<p>Jekyll is Ruby-based software. So you need to deal with Ruby. I tried wrapping it into <code>nix</code>, which I've been using at one of my jobs, but it was almost painfully slow. Also, I did not have any inspiration to write my custom themes and I did not find anything pretty for Jekyll. The default <a href=https://github.com/jekyll/minima>minima</a> theme is honestly just hot garbage.<p>I tried <a href=https://gohugo.io/>Hugo</a>, but it just didn't sit right with me. So, after doing some searching I settled with the combination of <a href=https://www.getzola.org/>Zola</a> with the <a href=https://github.com/Speyll/anemone>Anemone</a> theme. It is beatiful, it is fast, it does live reloads out of the box and Zola is just a single binary. No dependency hell, yay! And just a superior experience overall.<p>But the transition is not very straightforward. When you have a bunch of links you posted across the Internet, you want to keep them alive regardless of what software you use to generate your site. With the default settings (that I have been using, of course), Jekyll generates permalinks that look like this: <code>/blog/&LTyear>/&LTmonth>/&LTday>/&LTpage-name></code>. Well, Zola doesn't do that. And <a href=https://github.com/getzola/zola/issues/635#issuecomment-524564469>doesn't plan</a> to do that. Not a big issue for any <em>future</em> pages, I literally don't care. But old permalinks and the feed need to be preserved somehow. Oh, and the time format is incompatible too, since Zola sticks to RFC3339.<p>Ok, this is going to be an interesting evening and I need some beer. Let's get started...<h2 id=the-setup>The setup</h2><p>Assuming you have done the initial setup with Zola and Anemone, let's create our blog page:<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>mkdir</span><span> content/blog
</span><span style=color:#bf616a>cp</span><span> themes/anemone/content/blog/_index.md content/blog
</span></code></pre><p>Now we have an empty blog. Next, let's copy the contents of our old Jekyll-based blog.<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>cp </span><span>&LTpath-to-jekyll-blog>/_posts/*.md content/blog
</span></code></pre><p>Now we have an empty blog that doesn't work. <strong>Awesome.</strong><h2 id=timestamps>Timestamps</h2><p>That's an easy one. Jekyll timestamps this form <code>2018-08-11 18:42:00 +0300</code> aren't RFC-compatible. But something like this is: <code>2018-08-11 18:42:00+03:00</code>. This calls for a simple <code>sed</code> line:<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>sed -i -e </span><span>'</span><span style=color:#a3be8c>s/ +0300/+03:00/g</span><span>' content/blog/**/*.md
</span></code></pre><p>If you have multiple timezones, just do that for these timezones as well. It can be done nicer, but for me it was only two timezones, so I can't be bothered.<p>Now we have the blog that works, but the permalinks are not the same and we need to fix that.<h2 id=permalinks>Permalinks</h2><p>We have no choice but to make up for the lack of this capability in Zola by leveraging the directory structure. E.g. do something like this:<pre style=color:#c0c5ce;background-color:#2b303b><code><span>content
</span><span>â”œâ”€â”€ blog
</span><span>â”‚Â Â  â”œâ”€â”€ 2018
</span><span>â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 08
</span><span>â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 11
</span><span>â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 2018-08-11-tiny-docker-images.md
</span></code></pre><p>Yes, it's bad, but it works and these are old posts, so I am not going to touch most of them anyway.<p>I did the job with a simple Python script:<pre class=language-python data-lang=python style=color:#c0c5ce;background-color:#2b303b><code class=language-python data-lang=python><span style=color:#b48ead>import </span><span>os
</span><span style=color:#b48ead>import </span><span>pathlib
</span><span style=color:#b48ead>import </span><span>shutil
</span><span>
</span><span style=color:#65737e># front matter for intermittent _index.md files
</span><span style=color:#bf616a>FRONT_MATTER </span><span>= """
</span><span style=color:#a3be8c>---
</span><span style=color:#a3be8c>render: false
</span><span style=color:#a3be8c>transparent: true
</span><span style=color:#a3be8c>redirect_to: "/blog/"
</span><span style=color:#a3be8c>---
</span><span>"""
</span><span>
</span><span style=color:#bf616a>BASE </span><span>= "</span><span style=color:#a3be8c>content/blog/</span><span>"
</span><span>
</span><span>files = os.</span><span style=color:#bf616a>listdir</span><span>(</span><span style=color:#bf616a>BASE</span><span>)
</span><span>
</span><span style=color:#b48ead>for </span><span>file </span><span style=color:#b48ead>in </span><span>files:
</span><span>    </span><span style=color:#65737e># don't do anything for _index.md
</span><span>    </span><span style=color:#b48ead>if </span><span>file == "</span><span style=color:#a3be8c>_index.md</span><span>":
</span><span>        </span><span style=color:#b48ead>continue
</span><span>    </span><span style=color:#65737e># construct directory paths
</span><span>    sections = file.</span><span style=color:#bf616a>split</span><span>("</span><span style=color:#a3be8c>-</span><span>")[:</span><span style=color:#d08770>3</span><span>]
</span><span>    pf = </span><span style=color:#bf616a>BASE </span><span>+ "</span><span style=color:#a3be8c>/</span><span>".</span><span style=color:#bf616a>join</span><span>(sections)
</span><span>    </span><span style=color:#65737e># create these dirs
</span><span>    pathlib.</span><span style=color:#bf616a>Path</span><span>(pf).</span><span style=color:#bf616a>mkdir</span><span>(</span><span style=color:#bf616a>parents</span><span>=</span><span style=color:#d08770>True</span><span>, </span><span style=color:#bf616a>exist_ok</span><span>=</span><span style=color:#d08770>True</span><span>)
</span><span>    </span><span style=color:#65737e># magical _index.md files
</span><span>    </span><span style=color:#b48ead>for </span><span>i </span><span style=color:#b48ead>in </span><span style=color:#96b5b4>range</span><span>(</span><span style=color:#d08770>1</span><span>, </span><span style=color:#d08770>4</span><span>):
</span><span>        p = </span><span style=color:#bf616a>BASE </span><span>+ "</span><span style=color:#a3be8c>/</span><span>".</span><span style=color:#bf616a>join</span><span>(sections[:i]) + "</span><span style=color:#a3be8c>/_index.md</span><span>"
</span><span>        </span><span style=color:#b48ead>with </span><span style=color:#96b5b4>open</span><span>(p, "</span><span style=color:#a3be8c>w</span><span>") </span><span style=color:#b48ead>as </span><span>f:
</span><span>            </span><span style=color:#96b5b4>print</span><span>(</span><span style=color:#bf616a>FRONT_MATTER</span><span>, </span><span style=color:#bf616a>file</span><span>=f)
</span><span>    </span><span style=color:#65737e># move our post to the correct place
</span><span>    shutil.</span><span style=color:#bf616a>move</span><span>(</span><span style=color:#bf616a>BASE </span><span>+ file, pf + "</span><span style=color:#a3be8c>/</span><span>" + file)
</span></code></pre><p>This script creates the appropriate directory structure, places our article inside it and creates empty <code>_index.md</code> files in all subdirectories. They are not rendered, but are needed for Zola to see your directory structure correctly. Otherwise your posts are not going to be rendered. <code>transparent: true</code> makes it so that whatever theme you are using it sees the posts nested inside these directories.<h2 id=preserving-feed-xml>Preserving <code>feed.xml</code></h2><p>If your Jekyll blog generated the RSS/Atom feed, you want to have it with Zola as well. Good news: Zola can do that. Bad news: out of the box you are limited to either <code>atom.xml</code> or <code>rss.xml</code>. That one is easy to solve, though. Just copy Zola's template to your <code>templates</code> directory and rename it:<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>wget</span><span> https://raw.githubusercontent.com/getzola/zola/b965c89d12689d658a70f67f78d9de76b1a1cf48/components/templates/src/builtins/atom.xml
</span><span style=color:#bf616a>mv</span><span> atom.xml feed.xml
</span></code></pre><p>Then add this to your <code>config.toml</code>:<pre class=language-toml data-lang=toml style=color:#c0c5ce;background-color:#2b303b><code class=language-toml data-lang=toml><span style=color:#bf616a>generate_feed </span><span>= </span><span style=color:#d08770>true
</span><span style=color:#bf616a>feed_filename </span><span>= "</span><span style=color:#a3be8c>feed.xml</span><span>"
</span></code></pre><p>Woohoo, you are set! Almost...<h2 id=fixing-links-in-anemone>Fixing links in Anemone</h2><p><strong>UPD 2025-04-16</strong>: this is not needed in the latest Anemone versions.<p>If you are using Anemone, this section is for you. If you don't, do check that all links in your templates are correct. I warned you.<p>Anyway, here are the patches to fix links in Anemone:<ul><li><a href=/patches/anemone-head.patch>themes/anemone/templates/head.html</a><li><a href=/patches/anemone-blog-page.patch>themes/anemone/templates/blog-page.html</a><li><a href=/patches/anemone-footer.patch>themes/anemone/templates/footer.html</a></ul><p>Just apply these patches and you are <em>finally</em> done.<h2 id=conclusion>Conclusion</h2><p>While the proper transition was definitely not straightforward, I definitely enjoy my new setup. It looks nice and it's a pleasure to work with. Zola is a great software and it has a vibrant community with some pretty nice design, like the one you are looking at right now.</div></article></main><footer><hr><div id=footer-container><p>Made using <a rel="noopener noreferrer" href=https://github.com/Speyll/anemone target=_blank>anemone</a> Zola theme.<p><a title="face icons" href=https://www.flaticon.com/free-icons/face>Face icons created by Freepik - Flaticon</a><p>Â© 2018-2025 Eugene Babichenko</div></footer><script defer src=https://eugene-babichenko.github.io/js/script.js></script>