<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content="index, follow" name=robots><link href=https://eugene-babichenko.github.io/rss.xml rel=alternate title=RSS type=application/rss+xml><title>Eugene Babichenko | Analyzing metrics from InfluxDB with Pandas</title><link as=style href=https://eugene-babichenko.github.io/css/style.css rel=preload><link crossorigin href=https://raw.githack.com/Speyll/suCSS/main/reset-min.css rel=stylesheet><link crossorigin href=https://raw.githack.com/Speyll/suCSS/main/suCSS-min.css rel=stylesheet><link href=https://eugene-babichenko.github.io/css/style.css rel=stylesheet><link href=https://eugene-babichenko.github.io/css/custom.css rel=stylesheet><link href=https://eugene-babichenko.github.io/favicon.ico rel=icon><body><nav id=nav-bar><a href=/> /home/ </a><a href=/blog> /blog/ </a><a href=https://github.com/eugene-babichenko> /github/ </a><a href=https://standwithukraine.com.ua/> /ðŸ‡ºðŸ‡¦ Support Ukraine/ </a><div aria-label="Toggle theme" class=theme-toggle data-icon-base=https://eugene-babichenko.github.io/icons.svg data-icon-dark=#darkMode data-icon-light=#lightMode data-sound-src=https://eugene-babichenko.github.io/click.ogg id=theme-toggle role=button tabindex=0><svg class=icon><use id=theme-icon></use></svg></div></nav><main><article class=post><header class=post-header><time datetime=2019-01-30T10:35:00+03:00>Published on: <span class=accent-data>2019-01-30</span> </time><h1>Analyzing metrics from InfluxDB with Pandas</h1></header><div class=post-content><p>Our team recently started using the <a href=https://www.influxdata.com/time-series-platform/>InfluxData stack</a> to collect metrics from our apps (we may transfer logs and other time-series stuff to it, but that's another story) and here is one feature that made me absolutely to fall in love with InfluxDB â€” the official <a href=https://pandas.pydata.org>Pandas</a> <a href=https://influxdb-python.readthedocs.io/en/latest/examples.html#tutorials-pandas>integration</a>. In this blog post I will briefly tell you what is so amazing about this integration and why you definitely should try it.<p>First of all, let's start with the installation of what we need for this tutorial:<pre style=color:#c0c5ce;background-color:#2b303b><code><span>pip3 install influxdb pandas seaborn
</span></code></pre><p><a href=https://seaborn.pydata.org><code>seaborn</code></a> is a nice wrapper around <a href=https://matplotlib.org><code>matplotlib</code></a> that provides developers with some routines related to plotting their data and stats.<p>Having that installed and the InfluxDB instance running let's get started with the actual coding.<pre class=language-python data-lang=python style=color:#c0c5ce;background-color:#2b303b><code class=language-python data-lang=python><span style=color:#b48ead>from </span><span>influxdb </span><span style=color:#b48ead>import </span><span>DataFrameClient
</span><span>
</span><span>client = </span><span style=color:#bf616a>DataFrameClient</span><span>(
</span><span>    '</span><span style=color:#a3be8c>localhost</span><span>', </span><span style=color:#65737e># DB server hostname
</span><span>    </span><span style=color:#d08770>1000</span><span>, </span><span style=color:#65737e># DB server port
</span><span>    '</span><span style=color:#a3be8c>lrdata</span><span>', </span><span style=color:#65737e># DB user
</span><span>    '</span><span style=color:#a3be8c>12345678</span><span>', </span><span style=color:#65737e># Password
</span><span>    '</span><span style=color:#a3be8c>metrics</span><span>' </span><span style=color:#65737e># DB name
</span><span>)
</span><span style=color:#65737e># Here we fetch the execution timings for a hypothetical JSON RPC method
</span><span style=color:#65737e># providing registration to the service. This uses InfluxQL.
</span><span style=color:#65737e># NOTE: This function returns a Pandas dataframe!
</span><span>res = client.</span><span style=color:#bf616a>query</span><span>(</span><span style=color:#b48ead>f</span><span>'</span><span style=color:#a3be8c>select "execution_time" from "rpc_api.register"</span><span>')
</span><span>res = res['</span><span style=color:#a3be8c>rpc_api.register</span><span>']
</span></code></pre><p>Now we have a Pandas dataframe and we can easily fetch some statistics from it:<pre class=language-python data-lang=python style=color:#c0c5ce;background-color:#2b303b><code class=language-python data-lang=python><span>mean_time = res.</span><span style=color:#bf616a>mean</span><span>()
</span><span>median_time = res.</span><span style=color:#bf616a>median</span><span>()
</span></code></pre><p>And we won't stop with that! Let's build some histogram and plots that will give us more insight into the performance:<pre class=language-python data-lang=python style=color:#c0c5ce;background-color:#2b303b><code class=language-python data-lang=python><span style=color:#b48ead>import </span><span>seaborn
</span><span>
</span><span style=color:#65737e># We can build a histogram
</span><span>seaborn.</span><span style=color:#bf616a>distplot</span><span>(res)
</span><span>
</span><span style=color:#65737e># Or just draw all measures in a single plot
</span><span style=color:#65737e># 1. Add index (timestamps) as a separate column
</span><span>res['</span><span style=color:#a3be8c>time</span><span>'] = res.index
</span><span style=color:#65737e># 2. Draw the actual plot
</span><span>seaborn.</span><span style=color:#bf616a>lineplot</span><span>(</span><span style=color:#bf616a>x</span><span>='</span><span style=color:#a3be8c>time</span><span>', </span><span style=color:#bf616a>y</span><span>='</span><span style=color:#a3be8c>execution_time</span><span>', </span><span style=color:#bf616a>data</span><span>=res)
</span><span>
</span><span style=color:#65737e># CDF is also easy and sometimes easier to read than histograms
</span><span>seaborn.</span><span style=color:#bf616a>distplot</span><span>(res, </span><span style=color:#bf616a>hist</span><span>=</span><span style=color:#d08770>False</span><span>, </span><span style=color:#bf616a>kde_kws</span><span>=</span><span style=color:#bf616a>dict</span><span>(</span><span style=color:#bf616a>cumulative</span><span>=</span><span style=color:#d08770>True</span><span>))
</span></code></pre><p>Use <code>.get_figure().savefig('plot_name.png')</code> on any of the plotting expressions to save your plots to files.<p>You can check out how it works in <a href=https://ipython.org/notebook.html>IPython Notebook</a> in <a href=https://gist.github.com/eugene-babichenko/990bfc1bb7d5455a931d3e6348fc2cf0>this Gist</a>.<p>So as you can see you can extract and visualize your metrics statistics from InfluxDB with a couple lines of Python. Have fun!</div></article></main><footer><hr><div id=footer-container><p>Made using <a rel="noopener noreferrer" href=https://github.com/Speyll/anemone target=_blank>anemone</a> Zola theme.<p><a title="face icons" href=https://www.flaticon.com/free-icons/face>Face icons created by Freepik - Flaticon</a><p>Â© 2018-2025 Eugene Babichenko</div></footer><script defer src=https://eugene-babichenko.github.io/js/script.js></script>